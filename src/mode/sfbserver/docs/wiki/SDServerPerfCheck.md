# Skype for Business Server Performance Check

**Owner:** Mike McIntyre

# Description

Performs various performance related checks on the system.

[[_TOC_]]

# Execution flow

::: mermaid
graph LR

Parameter1[\Parameter1\] -.-> Scenario(Scenario)
Parameter2[\Parameter2\] -.-> Scenario(Scenario)
Parameter3[\Parameter3\] -.-> Scenario(Scenario)
Scenario --> Analyzer1(Analyzer1)
Analyzer1 --> Rule1(Rule1)
Rule1 --> Insight1(Insight1)
Rule1 --> Insight2(Insight2)
Insight1 --> Detection(Detection)
Insight1 --> Action(Action)
Insight2 --> ...(...)
:::

---

::: mermaid
graph LR

%%
%% Scenario Name: SDServerPerfCheck
%% Date Generated: 3/29/2022 10:33:55 AM
%% This file is autogenerated. Please do not edit directly
%%

    SDServerPerfCheck(SDServerPerfCheck) --1--> ADServerPerfCheck[ADServerPerfCheck]

    ADServerPerfCheck -- 1.1 --> RDCheckCertsExpiring[RDCheckCertsExpiring]
    ADServerPerfCheck -- 1.2 --> RDCheckDiskHealthStatus[RDCheckDiskHealthStatus]
    ADServerPerfCheck -- 1.3 --> RDCheckLocalSQLServerSchemaVersion[RDCheckLocalSQLServerSchemaVersion]
    ADServerPerfCheck -- 1.4 --> RDCheckLocalSQLVersion[RDCheckLocalSQLVersion]
    ADServerPerfCheck -- 1.5 --> RDCheckMultihomedServer[RDCheckMultihomedServer]
    ADServerPerfCheck -- 1.6 --> RDCheckPatchVersion[RDCheckPatchVersion]
    ADServerPerfCheck -- 1.7 --> RDCheckPowerPlan[RDCheckPowerPlan]
    ADServerPerfCheck -- 1.8 --> RDCheckSQLLogs[RDCheckSQLLogs]
    ADServerPerfCheck -- 1.9 --> RDDBDriveFull[RDDBDriveFull]
    ADServerPerfCheck -- 1.10 --> RDServerCores[RDServerCores]
    ADServerPerfCheck -- 1.11 --> RDServerLicenseVersion[RDServerLicenseVersion]
    ADServerPerfCheck -- 1.12 --> RDServerMemory[RDServerMemory]
    ADServerPerfCheck -- 1.13 --> RDServerSocketCoreRatio[RDServerSocketCoreRatio]
    ADServerPerfCheck -- 1.14 --> RDSqlIOLatency[RDSqlIOLatency]

:::

# Rule specifications

### R1 - RDCheckCertsExpiring

- Determine if any Skype for Business Server certs are near expiry

```powershell
    # Check all the certificates on the local server configured for
    # Skype for Business. Look for expiring date within next 45 days.
    # If found, alert user on renewing the specific certificate using
    # a message.
    $expiry               = (Get-Date).AddDays(45)
    $ExpiringCertificates = Get-CsCertificate | Where-Object {$_.NotAfter -lt $expiry}

    if (-not [string]::IsNullOrEmpty($ExpiringCertificates))
    {
        if ($ExpiringCertificates.Count -gt 0)
        {
            throw 'IDExpiringCertificates'
        }
    }
```

### R2 - RDCheckDiskHealthStatus

- Determine if the disk status on the server for database and logs disks is 'Healthy'

```powershell
    # Check the disk status on the server for database and log disks,
    # validate its healthy by looking at HealthStatus attribute has
    # the value set to ‘Healthy’
    #
    # If it is not found healthy, notify user with the message, and
    # recommend looking into system event logs for any disk errors
    # and looking at the disk troubleshooting from OS
    # (Operating Systems) perspective
    #

    $DiskHealthStatus = Get-DiskStorageNodeView | Where-Object {$_.HealthStatus -ne 'Healthy'}

    if (-not [string]::IsNullOrEmpty($DiskHealthStatus))
    {
        throw 'IDUnhealthyDisk'
    }
```

### R3 - RDCheckLocalSQLServerSchemaVersion

- Determine if local SQL Server database installed version is different than expected version

```powershell
    $csLocalDatabases = Test-CsDatabase -LocalService -WarningAction SilentlyContinue

    if(-not [string]::IsNullOrEmpty($csLocalDatabases))
    {
        foreach($csLocalDatabase in ($csLocalDatabases | `
                                        Where-Object {[string]$_.ExpectedVersion -ne [string]$_.InstalledVersion}))
        {
            if ($csLocalDatabase.DatabaseName -ne "xds")
            {
                throw 'IDLocalSQLServerSchemaVersionMismatch'
                }
        }
    }
    else
    {
        # Test-CsDatabase returned a null
        throw 'IDTestCsDatabaseNoResults'
    }
```

### R4 - RDCheckLocalSQLVersion

- Determine if the correct version of SQL Server Express is installed.

```powershell
    $ServerFqdn = Resolve-DnsName -Name $env:COMPUTERNAME -Type A -ErrorAction SilentlyContinue

    if (-not [string]::IsNullOrEmpty($ServerFqdn))
    {
        $ServerFqdnName = $ServerFqdn.Name
        if (-not [string]::IsNullOrEmpty($ServerFqdnName))
        {
            if ($ServerFqdnName -is [array])
            {
                $ServerFqdnName = $ServerFqdnName[0]
            }

            $PoolFqdn = Get-CsComputer -Identity $ServerFqdnName -ErrorAction SilentlyContinue

            if (-not [string]::IsNullOrEmpty($PoolFqdn))
            {
                $Service = Get-CsService -UserServer -PoolFqdn $PoolFqdn.Pool -ErrorAction SilentlyContinue

                if (-not [string]::IsNullOrEmpty($Service))
                {
                    $BackendFqdn = $Service.UserDatabase.split(":")[1]

                    if(-not [string]::IsNullOrEmpty($BackendFqdn))
                    {
                        $LocalSqlExpress = Test-CsDatabase -ConfiguredDatabases `
                                                                -SqlServerFqdn $BackendFqdn `
                                                                -ErrorAction SilentlyContinue `
                                                                -WarningAction SilentlyContinue
                        if (-not [string]::IsNullOrEmpty($LocalSqlExpress))
                        {
                            foreach ($instance in ($LocalSqlExpress | Where-Object {$_.DatabaseName -eq 'rtcxds' -and $_.SQLServerVersion.Edition -like '*Express*'}))
                            {
                                $SQLExpressVersion = $instance.SQLServerVersion.ProductVersion

                                if ([string]::IsNullOrEmpty($SQLExpressVersion))
                                {
                                    throw 'IDCheckSQLVersion'
                                }
                                else
                                {
                                    $ExpressSqlVersion = $global:SqlExpressVersions | Where-Object {$_.ProductVersion.Major -eq $SQLExpressVersion.Major}

                                    if($SQLExpressVersion.CompareTo($ExpressSQLVersion.ProductVersion) -lt 0)
                                    {
                                        throw 'IDUpgradeSQLExpress'
                                    }
                                }
                            }
                        }
                        else
                        {
                            throw 'IDTestCsDatabaseNoResults'
                        }
                    }
                }
                else
                {
                    throw 'IDUnableToGetServiceInfo'
                }
            }
            else
            {
                throw 'IDUnableToGetServiceInfo'
            }
        }
        else
        {
            throw 'IDUnableToResolveServerFQDN'
        }
    }
    else
    {
        throw 'IDUnableToResolveDNSName'
    }
```

### R5 - RDCheckMultihomedServer

- Determine if the server is multi-homed

```powershell
    $ServerFqdn = Resolve-DnsName -Name $env:COMPUTERNAME -Type A -ErrorAction SilentlyContinue

    if (-not [string]::IsNullOrEmpty($ServerFqdn))
    {
        $ServerFqdnName = $ServerFqdn.Name

        if (-not [string]::IsNullOrEmpty($ServerFqdnName))
        {
            $IPAddress = (Resolve-DnsName -Name $ServerFqdnName -Type A).IPAddress

            if (-not [string]::IsNullOrEmpty($IPAddress))
            {
                $count = @(Get-NetIPAddress -IPAddress $IPAddress -AddressFamily IPv4 -Type Unicast |
                                        Where-Object {$_.PrefixOrigin -ne 'WellKnown'}).Count

                if ($count -gt 1)
                {
                    # What is the WARNING/ERROR condition??
                    # 1 is good, >1 => WARNING
                    # ID: multi-homed detected machine. Not supported configuration
                    # IA: Point them to KB article
                    throw 'IDMultiHomePossible'
                }
            }
            else
            {
                throw 'IDUnableToResolveDNSName'
            }
        }
        else
        {
            throw 'IDUnableToResolveServerFQDN'
        }
    }
    else
    {
        throw 'IDUnableToResolveDNSName'
    }
```

### R6 - RDCheckPatchVersion

- Determine if the server is at, or above, currently recommended patch level(s)

```powershell
    # Determine which version we're running
    $CurrentProduct = Get-CsServerVersion
    if(-not [string]::IsNullOrEmpty($CurrentProduct))
    {
        $ProductName = $global:SkypeForBusinessUpdates |
                            ForEach-Object {$_.ProductName} |
                            Sort-Object -Unique |
                            Where-Object {$CurrentProduct.Contains($_)}

        if(-not [string]::IsNullOrEmpty($ProductName))
        {
            $expectedPatches = $global:SkypeForBusinessUpdates | Where-Object {$_.ProductName -eq $ProductName}
            $actualPatches   = Get-csServerPatchVersion

            foreach($patch in $actualPatches)
            {
                $patchFound = $expectedPatches | Where-Object {$_.ComponentName -eq ($patch.ComponentName.Split(',')[1].TrimStart(' '))}

                if (-not [string]::IsNullOrEmpty($patchFound))
                {
                    if (([System.Version]$patch.Version).CompareTo($patchFound.Version) -ge 0)
                    {
                        break
                    }
                    else
                    {
                        throw 'IDPatchUpdateAvailable'
                    }
                }
            }
        }
        else
        {
            throw 'IDUnableToGetProductName'
        }
    }
    else
    {
        throw 'IDUnableToGetVersion'
    }
```

### R7 - RDCheckPowerPlan

- Determine the power plan configuration

```powershell
    $PowerPlan = Get-WmiObjectHandler -Namespace root/cimv2/power -Class Win32_PowerPlan

    $Others   = $PowerPlan | Where-Object {$_.IsActive -and $_.ElementName -ne 'High performance'}
    $HighPerf = $PowerPlan | Where-Object {$_.ElementName -eq 'High performance'}

    if (-not $HighPerf.IsActive -or -not [string]::IsNullOrEmpty($Others))
    {
        throw 'IDWrongPowerPlan'
    }
```

### R8 - RDCheckSQLLogs

- Determine if the SQL server transaction logs are too large

```powershell
    $ServerFqdn = Resolve-DnsName -Name $env:COMPUTERNAME -Type A -ErrorAction SilentlyContinue

    if (-not [string]::IsNullOrEmpty($ServerFqdn))
    {
        $ServerFqdnName = $ServerFqdn.Name
        if (-not [string]::IsNullOrEmpty($ServerFqdnName))
        {
            if ($ServerFqdnName -is [array])
            {
                $ServerFqdnName = $ServerFqdnName[0]
            }

            $PoolFqdn = Get-CsComputer -Identity $ServerFqdnName -ErrorAction SilentlyContinue

            if (-not [string]::IsNullOrEmpty($PoolFqdn))
            {
                $Service = Get-CsService -UserServer -PoolFqdn $PoolFqdn.Pool -ErrorAction SilentlyContinue

                if (-not [string]::IsNullOrEmpty($Service))
                {
                    $BackendFqdn = $Service.UserDatabase.split(":")[1]

                    if(-not [string]::IsNullOrEmpty($BackendFqdn))
                    {
                        $csRemoteDatabases = Test-CsDatabase -ConfiguredDatabases `
                                                                -SqlServerFqdn $BackendFqdn `
                                                                -ErrorAction SilentlyContinue `
                                                                -WarningAction SilentlyContinue
                        if (-not [string]::IsNullOrEmpty($csRemoteDatabases))
                        {
                            foreach ($remoteDatabase in ($csRemoteDatabases | Where-Object {$_.DatabaseName -eq 'rtcxds'}))
                            {
                                $logSpace = Invoke-SqlCmd -ServerInstance $remoteDatabase.DataSource `
                                                -Query 'DBCC SQLPERF(logspace)'

                                if (-not [string]::IsNullOrEmpty($logSpace))
                                {
                                    $logSpaceUsed = ($logSpace | Where-Object {$_.'Database Name' -eq 'rtcxds'}).'Log Space Used (%)'

                                    if ($logSpaceUsed -gt $global:SQLLogSpaceThreshold)
                                    {
                                        throw 'IDLogSpaceThreshold'
                                    }
                                }
                                else
                                {
                                    throw 'IDNoLogSpace'
                                }
                            }
                        }
                        else
                        {
                            throw 'IDTestCsDatabaseNoResults'
                        }
                    }
                }
                else
                {
                    throw 'IDUnableToGetServiceInfo'
                }
            }
            else
            {
                throw 'IDUnableToGetServiceInfo'
            }
        }
        else
        {
            throw 'IDUnableToResolveServerFQDN'
        }
    }
    else
    {
        throw 'IDUnableToResolveDNSName'
    }
```

### R9 - RDDBDriveFull

- Determine if there are any DATABASE DRIVE FULL issues in the application log

```powershell
    # Check the database drive free space and alert if it's approaching its capacity.
    # Alert for event ID 30596 - ES_E_DATABASE_DRIVE_FULL

    $Events = Get-WinEvent -LogName 'LS User Services' -MaxEvents 300 | Where-Object {$_.Id -eq $ES_E_DATABASE_DRIVE_FULL}

    if ($Events)
    {
        throw 'IDSQLDriveFull'
    }

```

### R10 - RDServerCores

- Determine if the number of CPU cores available are correct

```powershell
    $Processor = Get-WmiObjectHandler -Class Win32_Processor

    if ($Processor.NumberOfCores -lt 6)
    {
        $CurrentProduct = Get-CsServerVersion
        if ($CurrentProduct -match "^(?<Product>.*)\((?<Version>\d+\.\d+\.\d+\.\d+)\):(?<License>.*$)")
        {
            $Product = $Matches.Product
        }

        throw 'IDInsufficientCores'
    }
```

### R11 - RDServerLicenseVersion

- Determine if we have a volume license key installed

```powershell
    $CurrentProduct = Get-CsServerVersion -ErrorAction SilentlyContinue

    if (-not [string]::IsNullOrEmpty($CurrentProduct))
    {
        if ($CurrentProduct -match "^(?<Product>.*)\((?<Version>\d+\.\d+\.\d+\.\d+)\):\s+(?<License>.*$)")
        {
            if ($Matches.License -like '*evaluation*')
            {
                throw 'IDEvalLicenseFound'
            }
        }
    }
    else
    {
        throw 'IDGetCsServerVersionFailed'
    }
```

### R12 - RDServerMemory

- Determine if the server meets the minimum required memory
```powershell
    $Memory = Get-WmiObjectHandler -Class Win32_ComputerSystem |
        Select-Object @{N="Memory";E={[math]::Round($_.TotalPhysicalMemory/(1GB))}},
        NumberOfProcessors, NumberOfLogicalProcessors

    $CurrentProduct = Get-CsServerVersion
    if ($CurrentProduct -match "^(?<Product>.*)\((?<Version>\d+\.\d+\.\d+\.\d+)\):(?<License>.*$)")
    {
        $Product = $Matches.Product

        if ($Product -like '*2015*')
        {
            $MinimumMemory = 32
        }
        elseif ($Product -like '*2019*')
        {
            $MinimumMemory = 64
        }
        else
        {
            throw 'IDUnknownProduct'
        }
    }
    else
    {
        throw 'IDUnknownProduct'
    }

    if ($Memory.Memory -lt $MinimumMemory)
    {
        throw 'IDInsufficientMemory'
    }
```

### R13 - RDServerSocketCoreRatio

- Determine if the correct number of CPU cores are assigned to SQL Server Express
```powershell
    $SQLCores = (Invoke-SQLCmd -Query "select cpu_count from sys.dm_os_sys_info" `
                                -ServerInstance 'localhost\RTCLOCAL').cpu_count

    if ([string]::IsNullOrEmpty($SQLCores) -or $SQLCores -lt 4)
    {
        throw 'IDInsufficientSQLCores'
    }
```

### R14 - RDSqlIOLatency

- Determine if there are any SQL I/O issues in the application log
```powershell
    # Look for the MSSQLServer Event ID 833 for IO performance issues in the past 300
    # events in the application event logs.

    $Events = Get-WinEvent -LogName Application -MaxEvents 300 | Where-Object {$_.Id -eq $BUF_LONG_IO}
    if ($Events)
    {
        throw 'IDSQLPerfIssues'
    }
```

# Messages

When particular rule detects an issue (return value is false) an **Insight detection**
and an **Insight Action** are displayed in addition to an **Analyzer message** and **Rule description**.
For more details, see example below:

(...)

- **_[TODO]_**

(...)

### Scenario Description

| **Language** | **Name**          | **Description**                             |
| :----------- | :---------------- | :------------------------------------------ |
| en-US        | SDServerPerfCheck | Skype for Business Server Performance Check |

### Analyzer Descriptions

| **#** | **Language** | **Name**          | **Description**                                                  |
| :---- | :----------- | :---------------- | :--------------------------------------------------------------- |
| A1    | en-US        | ADServerPerfCheck | Verifies key performance parameter for Skype for Business Server |

### Rule Descriptions

| **#** | **Language** | **Name**                           | **Description**                                                                             |
| :---- | :----------- | :--------------------------------- | :------------------------------------------------------------------------------------------ |
| R1    | en-US        | RDCheckCertsExpiring               | Determine if any Skype for Business Server certs are near expiry                            |
| R2    | en-US        | RDCheckDiskHealthStatus            | Determine if the disk status on the server for database and logs disks is 'Healthy'         |
| R3    | en-US        | RDCheckLocalSQLServerSchemaVersion | Determine if local SQL Server database installed version is different than expected version |
| R4    | en-US        | RDCheckLocalSQLVersion             | Determine if the correct version of SQL Server Express is installed.                        |
| R5    | en-US        | RDCheckMultihomedServer            | Determine if the server is multi-homed                                                      |
| R6    | en-US        | RDCheckPatchVersion                | Determine if the server is at, or above, currently recommended patch level(s)               |
| R7    | en-US        | RDCheckPowerPlan                   | Determine the power plan configuration                                                      |
| R8    | en-US        | RDCheckSQLLogs                     | Determine if the SQL server transaction logs are too large                                  |
| R9    | en-US        | RDDBDriveFull                      | Determine if there are any DATABASE DRIVE FULL issues in the application log                |
| R10   | en-US        | RDServerCores                      | Determine if the number of CPU cores available are correct                                  |
| R11   | en-US        | RDServerLicenseVersion             | Determine if we have a volume license key installed                                         |
| R12   | en-US        | RDServerMemory                     | Determine if the server meets the minimum required memory                                   |
| R13   | en-US        | RDServerSocketCoreRatio            | Determine if the correct number of CPU cores are assigned to SQL Server Express             |
| R14   | en-US        | RDSqlIOLatency                     | Determine if there are any SQL I/O issues in the application log                            |

### Insight detection descriptions

| **#** | **Language** | **Name**                              | **Description**                                                                                                                   |
| :---- | :----------- | :------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------- |
| ID1   | en-US        | IDCheckSQLVersion                     | Unable to determine if SQL version is correct for TLS 1.2.                                                                        |
| ID2   | en-US        | IDEvalLicenseFound                    | An evaluation license has been detected                                                                                           |
| ID3   | en-US        | IDExpiringCertificates                | The following certificate(s) are near expiry: {0}                                                                                 |
| ID4   | en-US        | IDGetCsServerVersionFailed            | Call to Get-CsServerVersion has failed.                                                                                           |
| ID5   | en-US        | IDInsufficientCores                   | Insufficient cores found                                                                                                          |
| ID6   | en-US        | IDInsufficientMemory                  | Insufficient memory found: Expected: {0}GB, Actual: {1}GB                                                                         |
| ID7   | en-US        | IDInsufficientSQLCores                | Insufficient number of cores allocated to SQL Server Express                                                                      |
| ID8   | en-US        | IDLocalSQLServerSchemaVersionMismatch | The Skype for Business Server local database: '{0}', installed version: '{1}', does not match expected version: '{2}'.            |
| ID9   | en-US        | IDLogSpaceThreshold                   | SQL server transaction logs on {0} at {1} are exceeding warning threshold. Expected a value of {2}% or less, actual value is {3}% |
| ID10  | en-US        | IDMultiHomePossible                   | A possible multi-home configuration was found. We expected to get a count of 1 IP address bound to the NIC but found {0} instead. |
| ID11  | en-US        | IDNoLogSpace                          | Not able to identify available transaction log space for database {1} associated to {0} data source.                              |
| ID12  | en-US        | IDPatchUpdateAvailable                | Out of date component found: {0} - Found {1} but {2} is available                                                                 |
| ID13  | en-US        | IDSQLDriveFull                        | SQL Server has data files have exceeded the maximum size or the hard drive it is located on has run out of space                  |
| ID14  | en-US        | IDSQLPerfIssues                       | SQL Server has encountered 1 (or more) occurrences of I/O requests taking longer than expected to complete.                       |
| ID15  | en-US        | IDTestCsDatabaseNoResults             | Unable to verify connectivity to one or more Skype for Business Server databases.                                                 |
| ID16  | en-US        | IDUnableToGetProductName              | Unable to locate 'Core Component'                                                                                                 |
| ID17  | en-US        | IDUnableToGetServiceInfo              | Unable to get information about the services and server roles being used in your Skype for Business Server infrastructure.        |
| ID18  | en-US        | IDUnableToGetVersion                  | Unable to determine current patch level on the server.                                                                            |
| ID19  | en-US        | IDUnableToResolveDNSName              | Unable to resolve DNS query for one or more of your Skype for Business Server server(s).                                          |
| ID20  | en-US        | IDUnableToResolveServerFQDN           | Unable to resolve the FQDN for your Skype for Business Server.                                                                    |
| ID21  | en-US        | IDUnhealthyDisk                       | One, or more, disks were found in an 'Unhealthy' state                                                                            |
| ID22  | en-US        | IDUnknownProduct                      | '{0}' is not an expected value                                                                                                    |
| ID23  | en-US        | IDUpgradeSQLExpress                   | Outdated version of SQL Server Express has been found. Expected: {0}, Actual: {1}                                                 |
| ID24  | en-US        | IDWrongPowerPlan                      | The power plan configuration is not correct. It should be set to 'High performance' only                                          |

### Insight action descriptions

| **#** | **Language** | **Name**                              | **Description**                                                                                                                                                                                                                                          |
| :---- | :----------- | :------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| IA1   | en-US        | IDCheckSQLVersion                     | Please verify connection to SQL server and refer to the following for guidance: https://support.microsoft.com/topic/kb3135244-tls-1-2-support-for-microsoft-sql-server-e4472ef8-90a9-13c1-e4d8-44aad198cdbe                                              |
| IA2   | en-US        | IDEvalLicenseFound                    | Please apply valid volume license key                                                                                                                                                                                                                    |
| IA3   | en-US        | IDExpiringCertificates                | Please renew certificates prior to expiration                                                                                                                                                                                                            |
| IA4   | en-US        | IDGetCsServerVersionFailed            | Please contact your system administrator or open a support ticket with Microsoft.                                                                                                                                                                        |
| IA5   | en-US        | IDInsufficientCores                   | Please refer to the appropriate documentation for your server installation.                                                                                                                                                                              |
| IA6   | en-US        | IDInsufficientMemory                  | Please refer to the appropriate documentation for your server installation.                                                                                                                                                                              |
| IA7   | en-US        | IDInsufficientSQLCores                | Expected: {0}, Actual: {1}. Please refer to the following guidance: https://docs.microsoft.com/sql/sql-server/compute-capacity-limits-by-edition-of-sql-server?view=sql-server-ver15                                                                     |
| IA8   | en-US        | IDLocalSQLServerSchemaVersionMismatch | Please install latest Skype for Business Server cumulative update.                                                                                                                                                                                       |
| IA9   | en-US        | IDLogSpaceThreshold                   | Please trim the SQL transaction logs.                                                                                                                                                                                                                    |
| IA10  | en-US        | IDMultiHomePossible                   | Dual or multi-homed configurations are not supported for Front End Servers, Back End Servers, and Standard Edition servers. Please refer to the following article https://docs.microsoft.com/skypeforbusiness/plan/system-requirements.                  |
| IA11  | en-US        | IDNoLogSpace                          | Please execute 'DBCC SQLPERF(logspace)' t-SQL command against database and confirm 'Log Space Used (%)' is less than 60%.                                                                                                                                |
| IA12  | en-US        | IDPatchUpdateAvailable                | Please update to {0} which can be found at {1}.                                                                                                                                                                                                          |
| IA13  | en-US        | IDSQLDriveFull                        | Please refer to the following guidance: https://systemcenter.wiki/?GetElement=Microsoft.LS.2013.Monitoring.Rule.InfoEvent.Registrar.ES_E_DATABASE_DRIVE_FULL&Type=Rule&ManagementPack=Microsoft.LS.2013.Monitoring.ComponentAndUser&Version=5.0.8308.956 |
| IA14  | en-US        | IDSQLPerfIssues                       | Please refer to the following guidance: https://docs.microsoft.com/sql/relational-databases/errors-events/mssqlserver-833-database-engine-error?view=sql-server-ver15                                                                                    |
| IA15  | en-US        | IDTestCsDatabaseNoResults             | The 'Test-CsDatabase -LocalService' returned an empty result. If problem persists please contact your system administrator or open a support ticket with Microsoft.                                                                                      |
| IA16  | en-US        | IDUnableToGetProductName              | Please verify if Get-CsServerVersion cmdlet returns a valid output.                                                                                                                                                                                      |
| IA17  | en-US        | IDUnableToGetServiceInfo              | Please confirm that 'Get-CsComputer' and 'Get-CsService' cmdlet execution is successful.                                                                                                                                                                 |
| IA18  | en-US        | IDUnableToGetVersion                  | Please verify if Get-CsServerVersion cmdlet returns a valid output.                                                                                                                                                                                      |
| IA19  | en-US        | IDUnableToResolveDNSName              | Please confirm that 'Resolve-DnsName' cmdlet successfully performs a DNS query for each Edge Server in the Edge pool and each Frontend in the Frontend pool.                                                                                             |
| IA20  | en-US        | IDUnableToResolveServerFQDN           | Please execute 'Resolve-DnsName -Name $env:COMPUTERNAME -Type A' cmdlet and confirm valid output is returned.                                                                                                                                            |
| IA21  | en-US        | IDUnhealthyDisk                       | Please review event logs for any disk errors                                                                                                                                                                                                             |
| IA22  | en-US        | IDUnknownProduct                      | '{0}' is not an expected value                                                                                                                                                                                                                           |
| IA23  | en-US        | IDUpgradeSQLExpress                   | Please upgrade to {0}: {1}                                                                                                                                                                                                                               |
| IA24  | en-US        | IDWrongPowerPlan                      | Please ensure that the power plan is set to 'High performance' only.                                                                                                                                                                                     |
